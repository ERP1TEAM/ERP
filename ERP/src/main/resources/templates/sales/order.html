<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"> 
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>주문등록</title> 
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/assets/materialize/css/materialize.min.css}" media="screen,projection" />
	<link rel="stylesheet" th:href="@{/assets/css/bootstrap.css}" />
	<link rel="stylesheet" th:href="@{/assets/css/font-awesome.css}" />
	<link rel="stylesheet" th:href="@{/assets/js/morris/morris-0.4.3.min.css}" />
	<link rel="stylesheet" th:href="@{/assets/css/custom-styles.css}" />
	<link rel="stylesheet" th:href="@{/assets/js/Lightweight-Chart/cssCharts.css}" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            text-align: center;
        }
        .readonly {
            background-color: #f5f5f5;
        }
        .table-responsive {
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <nav th:replace="~{/sales/header :: header}"></nav>
        
        <div th:replace="~{/sales/dropdown :: dropdown}"></div>

        <div th:replace="~{/sales/sidebar :: sidebar}" id="sidebar"></div>
        
        <div id="page-wrapper" style="background-color: #dcebdb">
            <div class="header"> 
                <h1 class="page-header">주문 등록</h1>      
            </div>
            
            <!-- main views-->
            <div id="page-inner">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-action">
                                 주문 등록
                            </div>
                            <div class="card-content">
                                <div class="table-responsive">
                                    <!-- 주문등록(서식) 파일 다운로드 링크 추가 -->
                                    <a href="/csv/주문등록(서식).xlsx" class="btn btn-primary" style="background-color: #126d1d; border: none;" download>주문등록 서식 다운로드 (.xlsx)</a>
                                    <br><br>
                                    
                                    <!-- 파일 업로드 UI -->
                                    <div class="file-upload-container" style="border: 2px dashed #cccccc; padding: 100px; text-align: center; cursor: pointer;">
                                        <h5>등록할 주문의 .xlsx 파일을 여기에 드래그하거나 클릭하여 업로드하세요</h5>
                                        <input type="file" id="fileInput" style="display: none;" />
                                    </div>
                                    <br>
                                    <!-- 선택한 파일명 표시 -->
                                    <p id="fileName" style="color: #126d1d;"></p>

                                    <button id="uploadButton" class="btn btn-primary" style="border: none; background-color:#474B54;" onclick="uploadFile()" disabled>주문 등록</button>
                                    <p id="uploadStatus"></p>
                                    
                                    <table>
                                        <tbody>
                                            <!-- 첫 번째 행 -->
                                            <tr>
                                                <th>수취인</th>
                                                <td><input type="text" id="recipientName" placeholder="수취인"></td>
                                                <th>수취인 연락처</th>
                                                <td><input type="text" id="recipientPhone" placeholder="수취인 연락처"></td>
                                                <th>수취인 이메일</th>
                                                <td><input type="email" id="recipientEmail" placeholder="수취인 이메일"></td>
                                                <th>수취인 우편번호</th>
                                                <td>
                                                    <input type="text" id="recipientPostcode" class="readonly" placeholder="우편번호" readonly>
                                                    <button type="button" onclick="findPostcode()">주소 찾기</button>
                                                </td>
                                                <th>수취인 도로명 주소</th>
                                                <td><input type="text" id="recipientAddress" class="readonly" placeholder="도로명 주소" readonly></td>
                                                <th>수취인 상세주소</th>
                                                <td><input type="text" id="recipientDetailAddress" placeholder="상세주소"></td>
                                            </tr>
                                            <!-- 세 번째 행 -->
                                            <tr>
                                                <th>주문 상품코드</th>
                                                <td><input type="text" id="productCode" placeholder="상품코드" oninput="fetchProductName()"></td>
                                                <th>주문 상품명</th>
                                                <td><input type="text" id="productName" class="readonly" placeholder="상품명" readonly></td>
                                                <th>주문 갯수</th>
                                                <td><input type="number" id="productQuantity" placeholder="주문 갯수"></td>
                                                <th>관리자 메모</th>
                                                <td colspan="5"><input type="text" id="adminMemo" placeholder="관리자 메모" style="width: 100%;"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <br>
                                    <button id="submitOrder" class="btn btn-primary" style="border: none; background-color:#474B54;">주문 등록</button>
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
                
                <footer>
                    <p>Copyright 2024 ⓒ quickkoala.com by <i class="fa fa-love"></i><a href="http://quickkoala.com">Quick Koala All right reserved.</a></p>
                </footer>
            </div>
        </div>
    </div>

    <!-- Daum 주소찾기 API -->
    <script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
    <script>
        function findPostcode() {
            new daum.Postcode({
                oncomplete: function(data) {
                    document.getElementById('recipientPostcode').value = data.zonecode;
                    document.getElementById('recipientAddress').value = data.roadAddress;
                }
            }).open();
        }

        // 주문상품코드를 입력하면 주문상품명을 자동으로 출력
        function fetchProductName() {
            const productCode = document.getElementById('productCode').value;
            const productNameField = document.getElementById('productName');

            // 서버로부터 상품명 조회 (예시로 하드코딩된 데이터를 사용)
            if (productCode === 'P12345') {
                productNameField.value = '상품명1';
            } else if (productCode === 'P54321') {
                productNameField.value = '상품명2';
            } else {
                productNameField.value = ''; // 코드가 없을 경우 빈칸 처리
            }
        }
    </script>

    <script th:src="@{/js/order.js}"></script>
    <script th:src="@{/assets/js/jquery-1.10.2.js}"></script>
    <script th:src="@{/assets/js/bootstrap.min.js}"></script>
    <script th:src="@{/assets/materialize/js/materialize.min.js}"></script>
</body>
</html>
